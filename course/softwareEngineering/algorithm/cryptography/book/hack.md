## ç ´è§£å¯†ç¢¼

### å‰è¨€

åœ¨ä¸Šä¸€ç« ä¸­ï¼Œæˆ‘å€‘ä»‹ç´¹äº† 4 å€‹ç°¡å–®çš„åŠ å¯†æ–¹æ³•ï¼ŒåŒ…å«ã€Œå‡±æ’’å¯†ç¢¼ã€ã€ã€Œç¶­å‰å°¼äºžå¯†ç¢¼ã€ã€ã€ŒXOR å¯†ç¢¼ã€èˆ‡
ã€Œæ­é…å½éš¨æ©Ÿæ•¸çš„ XOR å¯†ç¢¼ã€ç­‰å››ç¨®ï¼Œè©²æ–‡çš„ç¶²å€å¦‚ä¸‹ï¼š

ç¾åœ¨ã€æˆ‘å€‘å°‡ç¹¼çºŒä»‹ç´¹å¦‚ä½•ç ´è§£é€™äº›ç°¡å–®çš„åŠ å¯†æ–¹æ³•ã€‚

### å‡±æ’’å¯†ç¢¼çš„ç ´è§£

å‡±æ’’å¯†ç¢¼å¾ˆç°¡å–®çš„å°‡å­—æ¯ç§»å‹• k ä½ï¼Œä¾‹å¦‚è‹¥å°‡ abcde ç§»å‹• 3 ä½ï¼Œé‚£éº¼å°‡è®Šæˆ defghã€‚ç•¶æˆ‘å€‘æƒ³è¦ç ´è§£ã€Œå‡±æ’’å¯†ç¢¼ã€æ™‚ï¼Œä¸€å€‹
å¾ˆç°¡å–®çš„æƒ³æ³•å°±æ˜¯ï¼Œæ‰¾å‡º k çš„å€¼ï¼Œç„¶å¾Œåå‘ç§»å›žä¾†ï¼Œä¹Ÿå°±æ˜¯ç§»å‹• -k ä½ï¼Œå°±å¯ä»¥å›žåˆ°åŽŸä¾†çš„æ˜Žæ–‡ã€‚

è€Œä¸”ã€å¦‚æžœæ˜¯å°è‹±æ–‡åŠ å¯†ï¼Œé‚£éº¼ç”±æ–¼åªæœ‰ 26 å€‹å­—æ¯ï¼Œå› æ­¤ k çš„ç¯„åœå°±é™åˆ¶åœ¨ 0-25 ä¹‹é–“ï¼Œå› ç‚ºç§»å‹• 26 ä½çš„è©±ï¼Œå°±ç›¸ç•¶æ–¼æ²’æœ‰
ç§»ä½ (k=0)ã€‚æ‰€ä»¥ï¼Œæˆ‘å€‘åªè¦å°‡ 26 ç¨®å¯èƒ½æ€§éƒ½è§£å‡ºä¾†ï¼Œç„¶å¾Œç”¨äººçœ¼çœ‹çœ‹å“ªä¸€ç¨®æœ€æœ‰æ„ç¾©ï¼Œæ‡‰è©²å°±å¯ä»¥ç ´è§£é€™å€‹åŠ å¯†æ³•äº†ã€‚

### ç¶­å‰å°¼äºžå¯†ç¢¼çš„ç ´è§£

ç¶­å‰å°¼äºžå¯†ç¢¼æ˜¯å°‡ã€Œå‡±æ’’å¯†ç¢¼ã€çš„å¯†é‘°æ“´å±•æˆå¤šå€‹ï¼Œå› æ­¤å…¶å¯†é‘°å¯ä»¥è¡¨ç¤ºæˆ 

> k1, k2, k3, ..., kn

å°æ–¼è‹±æ–‡æ–‡ç« è€Œè¨€ï¼Œå¦‚æžœ n å¤ å¤§ (ä¾‹å¦‚ 10)ï¼Œé‚£éº¼æŽ¡ç”¨åˆ—èˆ‰çš„æ–¹å¼å°±æœƒè®Šå¾—å¾ˆå›°é›£ï¼Œå› ç‚º 26 çš„10æ¬¡æ–¹å°‡æœƒæ˜¯å€‹å¾ˆå¤§çš„æ•¸å­—ã€‚

ä½†æ˜¯ã€ç”±æ–¼è‹±æ–‡å­—æ¯çš„é »çŽ‡åˆ†å¸ƒä¸å‡å‹»ï¼Œåƒæ˜¯ z å°±å¾ˆå°‘å‡ºç¾ï¼Œå› æ­¤åªè¦èƒ½å–å¾—å¤§é‡çš„ç§˜æ–‡ï¼Œç„¶å¾Œé€²è¡Œçµ±è¨ˆï¼Œè€Œä¸”çŸ¥é“å„å€‹å­—æ¯åŽŸæœ¬çš„çµ±è¨ˆå‡ºç¾é »çŽ‡ï¼Œ
å°±æœ‰å¯èƒ½é€éŽã€Œé »çŽ‡åˆ†æžã€æ³•çŒœæ¸¬å‡ºé€™äº›å¯†é‘°ã€‚

ç”šè‡³ã€å¦‚æžœé€²ä¸€æ­¥åŽ»åˆ†æžåƒ of, is, are, this, that é€™ç¨®å¸¸ç”¨è©žå½™çš„é »çŽ‡ï¼Œå°±æ›´æœ‰å¯èƒ½åŽ»ç ´è§£ã€Œç¶­å‰å°¼äºžå¯†ç¢¼ã€äº†ã€‚

è€Œä¸”ã€å‡å¦‚æ‚¨æ””æˆªåˆ°ä¸€å°æ®µçš„æ˜Žæ–‡ (è¶…éŽ n å€‹å­—æ¯)ï¼Œé‚£éº¼å°±èƒ½ç›´æŽ¥æ‰¾å‡º k1, ...., kn çš„å…¨éƒ¨å¯†é‘°äº†ã€‚èˆ‰ä¾‹è€Œè¨€ï¼Œå‡å¦‚æœ‰ä»¥ä¸‹çš„æ˜Žæ–‡ï¼Œ
è¢«æˆ‘å€‘ç”¨ k1, k2, k3 = 3, 2, 5 ç·¨æˆå¯†æ–‡å¦‚ä¸‹æ‰€ç¤ºï¼š

```
æ˜Žæ–‡ï¼šattackmiddleisland
å¯†æ–‡ï¼šdvy...............
```

ç•¶æˆ‘å€‘çŸ¥é“å‰ä¸‰å€‹å­—æ¯ dvy çš„æ˜Žæ–‡ç‚º att æ™‚ï¼Œæˆ‘å€‘å°±å¯ä»¥é€éŽä»¥ä¸‹çš„æ¯”å°æ–¹å¼çŸ¥é“å¯†é‘° k1, k2, k3 ç‚º 3, 2, 5 äº†ã€‚

```
k1 = 'd'-'a' = 3
k2 = 'v'-'t' = 2
k3 = 'y'-'t' = 5
```

### XOR å¯†ç¢¼çš„ç ´è§£

åŒæ¨£çš„ï¼Œå¦‚æžœå·²ç¶“çŸ¥é“ä¸€å°æ®µå¯†æ–‡èˆ‡æ˜Žæ–‡çš„å°æ‡‰é—œä¿‚ï¼Œé‚£éº¼ä¹Ÿå°±èƒ½è¼•æ˜“çš„ç ´è§£ XOR åŠ å¯†æ³•çš„å¯†ç¢¼äº†ï¼Œèˆ‰ä¾‹è€Œè¨€ï¼Œå‡å¦‚æŸå€‹ XOR åŠ å¯†æ³•
æŽ¡ç”¨ 32 å€‹ bit çš„å¯†é‘° kï¼Œå¦‚æžœæˆ‘å€‘çŸ¥é“äº†æŸæ®µæ˜Žæ–‡ï¼Œä¾‹å¦‚ï¼š

```
P[1..n] ASCII æ˜Žæ–‡    : a        t        t        a        c        k        {sp}     a        t        {sp}     7        /        4
        æ˜Žæ–‡16é€²ä½    : 61       74       74       61       63       6B       20       61       74       20       37       2F       34       
        æ˜Žæ–‡äºŒé€²ä½    : 01100001 01110100 01110100 01100001 01100011 01101011 00100000 01100001 01110100 00100000 00110111 00101111 00110100
S[1..n] XORå¯†æ–‡(2é€²ä½): 10000001 11001110 11010000 00110100 
K[1..4] è§£å‡ºå¯†é‘°      : 11100000 10111010 10100100 01010101  ...............................................................
```

å› æ­¤ã€åªè¦çŸ¥é“ 4 å€‹ byte çš„æ˜Žæ–‡ï¼Œå°±å¯ä»¥å®Œå…¨ç ´è§£æŽ¡ç”¨é•·åº¦ 32 bit å¯†é‘°çš„ XOR åŠ å¯†æ³•äº†ã€‚

ä¸€ä½†çŸ¥é“å¯†é‘°ä¹‹å¾Œï¼Œæˆ‘å€‘åªè¦åˆ©ç”¨å¯†é‘°èˆ‡å¯†æ–‡å®Œæ•´çš„åšä¸€æ¬¡ XOR é‹ç®—ï¼Œå°±å¯ä»¥å°‡æ˜Žæ–‡å®Œå…¨è§£å‡ºä¾†äº†ã€‚

å› ç‚º P XOR K = S, å‰‡ P = (P XOR K) XOR K = S XOR K ï¼Œé€™æ˜¯ XOR é‹ç®—çš„åŸºæœ¬ç‰¹æ€§å•Šï¼

çœ‹åˆ°é€™è£¡ï¼Œä¸€å®šæœ‰äººæœƒèªªï¼Œä¸Šè¿°çš„ç ´è§£æ³•æ ¹æœ¬å°±æ˜¯ä½œå¼Šï¼Œæˆ‘å€‘æ€Žéº¼æœ‰è¾¦æ³•çŸ¥é“é‚£ä¸€å°æ®µæ˜Žæ–‡å‘¢ï¼Ÿ

(ç­†è€…è¨»ï¼šå…¶å¯¦é€™ç¨®æƒ…æ³ä¸¦ä¸æ˜¯ç‰¹ä¾‹ï¼Œåœ¨ç¬¬ 1,2 æ¬¡ä¸–ç•Œå¤§æˆ°æ™‚ï¼Œäº¤æˆ°é›™æ–¹å¸¸å¸¸éƒ½å¯ä»¥æ‹¿åˆ°å°æ–¹çš„ä¸€äº›æ˜Žæ–‡ï¼Œä¾‹å¦‚æ”»é™·äº†æŸå€‹å ¡å£˜ï¼Œæˆ–è€…ç”¨é–“è«œ ....)

äº‹å¯¦ä¸Šã€å°æ–¼ XOR é€™ç¨®ç°¡å–®åž‹çš„åŠ å¯†æ³•è€Œè¨€ï¼Œå°±ç®—æ²’æœ‰æ‹¿åˆ°ä»»ä½•æ˜Žæ–‡ï¼Œä¹Ÿä¸æœƒçœŸçš„å¤ªé›£è§£ã€‚èˆ‰ä¾‹è€Œè¨€ï¼Œæ ¹æ“šè‹±æ–‡é€™å€‹èªžè¨€çš„ç‰¹æ€§ï¼Œæ‚¨æœƒç™¼ç¾
æœ‰å¾ˆå¤šè©žç¶“å¸¸æœƒå‡ºç¾ï¼Œåƒæ˜¯ (of, is, at, on, in, are, the, that, ....)ï¼Œè€Œä¸”åœ¨ç‰¹å®šçš„å ´åˆä¸­ï¼Œä¹Ÿæœƒæœ‰ä¸€äº›å¸¸è¦‹çš„é ˜åŸŸç”¨è©žï¼Œä¾‹å¦‚åœ¨æˆ°çˆ­ä¸­çš„ 
attack, move, .... ç­‰è©žå½™å‡ºç¾çš„é »çŽ‡æœƒè¼ƒé«˜ï¼Œæ–¼æ˜¯æˆ‘å€‘å°±å¯ä»¥å…ˆçŒœæ¸¬å“ªäº›è©žå½™æ‡‰è©²æœƒåœ¨æ˜Žæ–‡ç•¶ä¸­å‡ºç¾éŽã€‚ç„¶å¾Œå†å‡è¨­é€™äº›è©žå½™å°±æ˜¯æ˜Žæ–‡ï¼Œ
é€²è¡Œè§£å¯†ï¼Œå¦‚æžœé€™äº›è©žå½™çœŸçš„åœ¨æ˜Žæ–‡ä¸­å‡ºç¾éŽï¼Œé‚£éº¼å°±èƒ½å¤ æ­£ç¢ºçš„è§£å‡ºæ˜Žæ–‡äº†ã€‚

èˆ‰ä¾‹è€Œè¨€ï¼Œå‡å¦‚æˆ‘å€‘æ””æˆªåˆ°ä»¥ä¸‹çš„ XOR å¯†æ–‡ (å…¶ä¸­çš„ {sp} ä»£è¡¨ç©ºç™½å­—å…ƒ)ï¼Œè€Œä¸”æˆ‘å€‘çŸ¥é“å¯†é‘°çš„é•·åº¦ç‚º 32 bitsã€‚

> a t t a c k {sp} at {sp} 7 / 4

```
P[1..n] ASCII æ˜Žæ–‡    : a        t        t        a        c        k        {sp}     a        t        {sp}     7        /        4
        æ˜Žæ–‡16é€²ä½    : 61       74       74       61       63       6B       20       61       74       20       37       2F       34       
        æ˜Žæ–‡äºŒé€²ä½    : 01100001 01110100 01110100 01100001 01100011 01101011 00100000 01100001 01110100 00100000 00110111 00101111 00110100
S[1..n] XORå¯†æ–‡(2é€²ä½): 10000001 11001110 11010000 00110100 10000001 11001110 11010000 00110100 10000001 11001110 11010000 00110100 10000001
K[1..4] è§£å‡ºå¯†é‘°      : 11100000 10111010 10100100 01010101 11100010 10100101 11110000 01010101 11110101 11101110 11100111 00011011 10110101
```

å‡å¦‚æˆ‘å€‘å–å¾—çš„å¯†æ–‡æ•¸é‡è¼ƒå¤šï¼Œæˆ‘å€‘å°±å¯ä»¥å¾ˆæœ‰ä¿¡å¿ƒçš„èªç‚º {sp}at{sp} é€™ç¨®æ¨£å¼åœ¨å¯†æ–‡è£è‡³å°‘æœƒå‡ºç¾ä¸€æ¬¡ä»¥ä¸Šï¼Œæ–¼æ˜¯æˆ‘å€‘å°±å¯ä»¥ç”¨ä¸‹åˆ—æ–¹å¼è§£å¯†ï¼š

1. ç”¨ S[i..i+3] èˆ‡ {sp}at{sp} åš XORï¼Œå¾—åˆ° k'
2. ç”¨ k' åŽ»è§£æ•´å€‹å¯†æ–‡ï¼Œå¾—åˆ° p'
3. æª¢å¯Ÿçœ‹çœ‹ p' æ˜¯å¦ç‚ºåˆç†çš„æ˜Žæ–‡ï¼Œè‹¥æ˜¯å‰‡è¼¸å‡ºä¹‹ã€‚

ä»¥ä¸ŠéŽç¨‹å°æ¯å€‹ i éƒ½åšä¸€æ¬¡ï¼Œåªè¦æ˜Žæ–‡ä¸­æ›¾ç¶“å‡ºç¾ {sp}at{sp} é€™å€‹æ¨£å¼ï¼Œç¨‹å¼å°±å¯ä»¥æ‰¾å‡ºåˆç†çš„æ˜Žæ–‡è¼¸å‡ºäº†ã€‚

é‚£éº¼ï¼Œç”šéº¼å«åšã€Œåˆç†çš„æ˜Žæ–‡ã€å‘¢ï¼Ÿä¸€å€‹æ¯”è¼ƒæ„šç¬¨çš„æ–¹æ³•æ˜¯ç”¨äººçœ‹ï¼Œå¦‚æžœæ²’ä»€éº¼äº‚ç¢¼è€Œä¸”çœ‹å¾—å‡ºæ„ç¾©ï¼Œæ‡‰è©²å°±æ˜¯æ­£ç¢ºç­”æ¡ˆäº†ã€‚

ä½†æ˜¯é€™æ¨£çœ‹å¾ˆæµªè²»æ™‚é–“ï¼Œæˆ‘å€‘å¯ä»¥è®“ç¨‹å¼è‡ªå‹•å¹«æˆ‘å€‘çœ‹ï¼Œåªè¦ç”¨ä¸€äº›ç°¡å–®çš„åˆ¤æ–·è¦å‰‡å°±è¡Œäº†ã€‚

1. p' å¤§éƒ¨åˆ†éƒ½æ˜¯è‹±æ–‡å­—æ¯ï¼Œè€Œä¸” ASCII ç¢¼éƒ½ä»‹æ–¼ 32 åˆ° 126 ä¹‹é–“çš„å¯åˆ—å°å­—å…ƒã€‚
2. p' ä¸­çš„å­—è©žå¤§éƒ¨åˆ†éƒ½åœ¨å­—å…¸ä¸­å‡ºç¾éŽ (æˆ–è€…æ›´ç°¡å–®çš„ç”¨å¸¸ç”¨è©žå‡ºç¾æ¬¡æ•¸å¾ˆå¤šä¾†åˆ¤æ–·å°±è¡Œäº†)

åªè¦ç¬¦åˆä¸Šè¿°å…©å€‹æ¢ä»¶ï¼Œæˆ‘å€‘å°±èªç‚º p' æ˜¯åˆç†çš„æ˜Žæ–‡äº†ã€‚(å…¶å¯¦å¾ˆå¤šæ™‚å€™åªè¦ç¬¦åˆæ¢ä»¶ 1 å°±è¡Œäº†ã€‚

ç‚ºäº†æ›´æ¸…æ¥šçš„èªªæ˜Žä¸Šè¿°æƒ³æ³•ï¼Œæˆ‘å€‘ç›´æŽ¥æ’°å¯«äº†ä¸€å€‹ç¨‹å¼ä¾†é€²è¡Œ XOR å¯†ç¢¼çš„ç ´è§£å‹•ä½œï¼Œä»¥ä¸‹æ˜¯è©²ç¨‹å¼çš„åŸ·è¡Œçµæžœèˆ‡åŽŸå§‹ç¢¼ï¼š

![](xor_hack.png)

```
D:\Dropbox\CodeData\cryptography1>gcc xor_hack.c -o xor_hack

D:\Dropbox\CodeData\cryptography1>xor_hack
æ˜Žæ–‡=Zero-hour is July/4th 3.30 am
å¯†æ–‡=7Zï•·W?î‘˜u?B?Eç‹˜V?
i=00 score=15 key=17 33 77 ac  hackPlain= is Wdn,h<ZFt##5;,2aI<!.
i=01 score=19 key=60 7a 6d ff  hackPlain=W is -tiero-nptj/hee(2>u;}`
i=02 score=19 key=33 77 24 e5  hackPlain=- is =s,h;u~'j'gfr6ha(mxrg3
i=03 score=11 key=29 24 39 ac  hackPlain=~= is :6;&<dQ:#=4{;,;|aw+o.)
i=04 score=15 key=60 3e 6a b6  hackPlain=Wdn: is !u&-Ki9t.(!e!/{>1<4`
i=05 score=20 key=3f 77 70 e5  hackPlain-ti is hoursj+g2r:h5(ax&g?
i=06 score=19 key=6c 3f 39 ff  hackPlain=[e=s,h is &o!J:px/{hi |220o}l
i=07 score=16 key=76 6c 3f b6  hackPlain=A6;:6;& is &;<9b|}!ssz{(ci4v
i=08 score=13 key=3f 76 6c b0  hackPlain,h<!u& is ro?+f.':i)}ay:2?
i=09 score=26 key=6d 3f 76 e3  hackPlain=Zero-hour is July/4th 3.30 am
i=10 score=15 key=3e 55 3f f9  hackPlain=       ;u~&o!J is <v*E}n;Jz4`Zi{>
i=11 score=12 key=24 06 23 b0  hackPlain=\'<dQ:&;< is ?0a'!f}z      u2$
i=12 score=20 key=6d 1c 70 af  hackPlain=ZFt#-Ki9ro? is y28h5b3&-m
i=13 score=21 key=34 55 6a fc  hackPlain=nptsj+July is E(k1J/1jZ<~4
i=14 score=20 key=67 30 23 e6  hackPlain=Pj'j'g:px/<v*E is aqb/f+9?udg
i=15 score=17 key=7d 63 62 af  hackPlain=J9f#=4{9b|}?0a is 8x|'b#l4-}
i=16 score=19 key=34 79 31 b7  hackPlain=#5;t.(!+f.'y28 is 1ftzjvg54
i=17 score=18 key=25 30 2b e4  hackPlain=j/heg2r:/4thE(k1 is /n){?}f%
i=18 score=22 key=76 3f 62 fe  hackPlain=Aefr6h{hi }n;Jaqb/ is '3(04|v
i=19 score=18 key=6c 6c 65 b7  hackPlain=[6a;,;|!ssz'!f8x|' is z2c35l
i=20 score=17 key=25 76 36 ed  hackPlain=,2ae!/{:i)}h5b1ftz is {y`o%
i=21 score=19 key=7e 3f 2c be  hackPlain=Ie(2>h5(a 3.3J/1j/n){ is 0z<~
i=22 score=19 key=2d 2f 65 a4  hackPlain=ua(mx|220z4`Zf+9?'3(0 is 3&-
i=23 score=22 key=37 7c 76 ed  hackPlain=
i=24 score=17 key=7e 66 25 a2  hackPlain=I<!.>1<4ay:23&-jvg5{y`o is ~
é‚„åŽŸ=Zero-hour is July/4th 3.30 am
```

åœ¨ä¸Šè¿°çµæžœä¸­ï¼Œæ‚¨å¯ä»¥çœ‹åˆ°åˆ†æ•¸æœ€é«˜è€…ç‚º i=09 çš„ 26 åˆ†ï¼Œå°æ‡‰çš„æ–‡å­—ç‚ºã€ŒZero-hour is July/4th 3.30 amã€ï¼Œä¹Ÿå°±æ˜¯
çœŸæ­£çš„è§£ç­”ï¼Œå…¶å¯†é‘°ç‚º key=6d 3f 76 e3ï¼Œå› æ­¤æˆ‘å€‘å°±é€éŽé€™æ¨£çš„ç¨‹å¼ç ´è§£äº†é€™æ®µæ–‡å­—ï¼Œå› ç‚º {sp}is{sp} é€™å€‹æ¨£å¼çœŸ
çš„åœ¨æ–‡ç« ä¸­å‡ºç¾äº†ã€‚

æª”æ¡ˆï¼šxor_hack.c

```CPP
#include <stdio.h>
#define BYTE unsigned char

int encrypt(char plain[], char cipher[], int len, char key[], int keyLen) {
  int pi;
  for (pi=0; pi<len; pi++) {
	  int ki = pi%keyLen;
      cipher[pi] = plain[pi] ^ key[ki];
  }
}

int decrypt(char cipher[], char plain[], int len, char key[], int keyLen) {
  int pi;
  for (pi=0; pi<len; pi++) {
	  int ki = pi%keyLen;
      plain[pi] = cipher[pi] ^ key[ki];
  }
  plain[pi] = '\0';
}

int getKey(char cipher[], int from, char pattern[], char key[], int keyLen) {
  int i;
  for (i=from; i<from+keyLen; i++) {
    int ki = i % keyLen;
    key[ki] = pattern[i-from] ^ cipher[i];
  }
}

int inSetCount(char str[], int len, char set[]) {
  int i, count=0;
  for (i=0; i<len; i++) {
    if (strchr(set, str[i]) > 0)
	  count++;
  }
  return count;
}

int printHex(char key[], int keyLen) {
  int i;
  for (i=0; i<keyLen; i++) {
    printf("%02x ", (BYTE) key[i]);
  }
}

char goodSet[] = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789 ";

int hack(char cipher[], int len, char pattern[], char hackKey[], int keyLen, char hackPlain[]) {
  int i;
  for (i=0; i<len-keyLen; i++) {
    getKey(cipher, i, pattern, hackKey, keyLen);
	decrypt(cipher, hackPlain, len, hackKey, keyLen);
	int score = inSetCount(hackPlain, len, goodSet);
    printf("i=%02d score=%02d key=", i, score);
	printHex(hackKey, keyLen);
	printf(" hackPlain=%s\n", hackPlain);
  }
}

int main() {
  char plain[] = "Zero-hour is July/4th 3.30 am";
  char cipher[100], plain2[100], hackPlain[100];
  int  len = strlen(plain);
  char key[] = { 0x6D, 0x3F, 0x76, 0xE3 };
  char hackKey[4];
  int  keyLen = 4;
  
  printf("æ˜Žæ–‡=%s\n", plain);
  encrypt(plain, cipher, len, key, keyLen);
  printf("å¯†æ–‡=%s\n", cipher);
  hack(cipher, len, " is ", hackKey, keyLen, hackPlain);  
  decrypt(cipher, plain2, len, key, keyLen);
  printf("é‚„åŽŸ=%s\n", plain2);
}
```

### æ­é…å½éš¨æ©Ÿæ•¸çš„ XOR å¯†ç¢¼ä¹‹ç ´è§£

å¦‚æžœå°‡ XOR å¯†ç¢¼çš„ key æ”¹ç”¨å½éš¨æ©Ÿæ•¸ç”¢ç”Ÿï¼Œé‚£è¦ç ´è§£å°±æ›´å›°é›£äº†ä¸€äº›ï¼Œå¦‚æžœè©²å½éš¨æ©Ÿæ•¸çš„å‡½æ•¸å¯ä»¥é€éŽé€†æŽ¨è€Œå–å¾—ï¼Œ
é‚£éº¼å°±æ¯”è¼ƒå®¹æ˜“è™•ç†ï¼Œä½†ä¸€èˆ¬çš„å½éš¨æ©Ÿæ•¸å‡½æ•¸é€šå¸¸æ˜¯ä¸å®¹æ˜“é€†æŽ¨çš„ï¼Œå› æ­¤è¦ç ´è§£çš„é›£åº¦å°±æé«˜äº†ä¸å°‘ã€‚

ä½†æ˜¯å¦‚æžœæˆ‘å€‘èƒ½å¤ çŒœæ¸¬åˆ°æ•´å€‹å­—ä¸²çš„å­—é¦–æ˜¯ç”šéº¼å­—è©žï¼Œé‚£å°±èƒ½ç›´æŽ¥æ‰¾åˆ°ç¬¬ä¸€å€‹ keyï¼Œç„¶å¾Œå°±èƒ½é€éŽåŒæ¨£çš„å½éš¨æ©Ÿæ•¸ç”¢ç”Ÿå‡½æ•¸ï¼Œ
ç”¢ç”Ÿæ•´å€‹å½éš¨æ©Ÿæ•¸çš„ One-time padï¼Œç„¶å¾Œå†ç”¨ One-time pad èˆ‡å¯†æ–‡ä½œ XOR é‹ç®—ç”¢ç”Ÿæ˜Žæ–‡ï¼Œé€™æ¨£å°±èƒ½ç ´è§£ã€Œæ­é…å½éš¨æ©Ÿæ•¸
çš„ XOR åŠ å¯†æ³•ã€äº†ã€‚

å› æ­¤æ•´å€‹å•é¡Œå°±è®Šæˆäº†å¦‚ä½•çŒœæ¸¬å‡ºå­—é¦–æ˜¯ç”šéº¼å­—è©žï¼Œæˆ–è€…ç•¶æˆ‘å€‘çŒœæ¸¬å‡ºå…¶ä¸­æŸå€‹å­—è©žå¾Œï¼Œå°±èƒ½æŽ¨ç®—å‡ºå¾Œé¢çš„å½éš¨æ©Ÿæ•¸ï¼Œ
å› è€Œç ´è§£å¾ŒåŠéƒ¨çš„ keyï¼Œæ–¼æ˜¯å°±å¯ä»¥ç”¨ XOR çš„æ–¹æ³•è§£å‡ºäº†å¾ŒåŠéƒ¨çš„æ˜Žæ–‡ã€‚

æ‰€ä»¥æˆ‘å€‘åŒæ¨£å¯ä»¥ç”¨é¡žä¼¼ä¸Šè¿°çš„æ–¹æ³•ï¼Œåªæ˜¯ç›¡å¯èƒ½ç”¨å„ç¨®ã€Œåœ¨å­—é¦–å‡ºç¾æ©ŸçŽ‡è¼ƒå¤§çš„å­—è©žã€ï¼ŒåŽ»æ¯”å°å‡ºç¬¬ä¸€å€‹ keyï¼Œç„¶å¾Œç”¨é€™å€‹
key åŽ»ç”¢ç”Ÿå¾ŒçºŒçš„ key ï¼Œå†ç”¨ XOR æ³•è§£å¾—æ˜Žæ–‡ã€‚

### çµèªž

å¦‚æžœæ‚¨å°å¯†ç¢¼å­¸çš„æ­·å²æœ‰èˆˆè¶£çš„è©±ï¼Œç­†è€…è¦ºå¾—ä»¥ä¸‹é€™æœ¬æ›¸å¯«å¾—é‚„è »æ¸…æ¥šæœ‰è¶£çš„ï¼Œæä¾›æœ‰èˆˆè¶£çš„è®€è€…åšé€²ä¸€æ­¥çš„åƒè€ƒã€‚

* [å¤ä»Šå¯†ç å­¦è¶£è°ˆ](http://book.douban.com/subject/20281462/), ä½œè€…: çŽ‹å–„å¹³ , ç”µå­å·¥ä¸šå‡ºç‰ˆç¤¾

ç•¶ç„¶ã€åŠ è§£å¯†æŠ€è¡“åšå¤§ç²¾æ·±ï¼Œçµ•å°ä¸æ˜¯ç­†è€…é€™å…©ç¯‡æ–‡ç« å¯ä»¥æ¶µè“‹çš„ã€‚é€™å…©ç¯‡æ–‡ç« çš„ç›®çš„æ˜¯å¼•å°Žã€Œç¨‹å¼äººã€é€²å…¥å¯†ç¢¼å­¸çš„é ˜åŸŸï¼Œ
ç”¨ç°¡å–®çš„ç¨‹å¼èªªæ˜Žã€ŒåŠ è§£å¯†æŠ€è¡“ã€çš„åŽŸç†ï¼Œç„¶å¾ŒåŒæ¨£ç”¨ç¨‹å¼èªªæ˜Žç ´è§£å¯†ç¢¼çš„åŽŸç†ï¼Œå¸Œæœ›èƒ½è®“è®€è€…æ¸…æ¥šçš„ç†è§£åˆ°ã€ŒåŠ å¯†ã€è§£å¯†ã€
èˆ‡ç ´è§£å¯†ç¢¼ã€çš„éŽç¨‹èˆ‡åŽŸç†ï¼Œä»¥ä¾¿åšç‚ºé€²ä¸€æ­¥ç ”ç©¶çš„åŸºç¤Žã€‚

### åƒè€ƒæ–‡ç»
* ç¶­åŸºç™¾ç§‘:[ç•°æˆ–å¯†ç¢¼]
* ç¶­åŸºç™¾ç§‘:[å¯†ç¢¼å­¸]
* ç¶­åŸºç™¾ç§‘:[å‡±æ’’å¯†ç¢¼]
* ç¶­åŸºç™¾ç§‘:[ç¶­å‰å°¼äºžå¯†ç¢¼]
* Wikipedia:[Enigma]
* Wikipedia:[XOR_cipher]
* Wikipedia:[Vigenere Cipher]
* Wikipedia:[Vernam_cipher]
* Wikipedia:[One-time pad]


[å¯†ç¢¼å­¸]:http://zh.wikipedia.org/wiki/%E5%AF%86%E7%A2%BC%E5%AD%B8
[ç•°æˆ–å¯†ç¢¼]:http://zh.wikipedia.org/wiki/%E5%BC%82%E6%88%96%E5%AF%86%E7%A0%81
[ç¶­å‰å°¼äºžå¯†ç¢¼]:http://zh.wikipedia.org/wiki/%E7%BB%B4%E5%90%89%E5%B0%BC%E4%BA%9A%E5%AF%86%E7%A0%81
[å‡±æ’’å¯†ç¢¼]:http://zh.wikipedia.org/wiki/%E6%81%BA%E6%92%92%E5%AF%86%E7%A0%81
[Enigma]:http://en.wikipedia.org/wiki/Enigma_machine
[XOR_cipher]:http://en.wikipedia.org/wiki/XOR_cipher
[Vigenere Cipher]:http://en.wikipedia.org/wiki/Vigen%C3%A8re_cipher
[Vernam_cipher]:http://en.wikipedia.org/wiki/Vernam_cipher
[One-time pad]:http://en.wikipedia.org/wiki/One-time_pad
